(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[644],{142:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var s=a(5155),r=a(2115),l=a(5695),n=a(2099);function o(){let[e,t]=(0,r.useState)(!0),[a,o]=(0,r.useState)(null),[i,c]=(0,r.useState)(null),[d,m]=(0,r.useState)(null),[g,u]=(0,r.useState)(0),[p,x]=(0,r.useState)(""),[h,f]=(0,r.useState)(null),[b,w]=(0,r.useState)(null),v=(0,l.useSearchParams)(),j=(0,l.useRouter)();v.get("gender"),v.get("poster"),(0,r.useEffect)(()=>{let e=localStorage.getItem("userImage"),t=localStorage.getItem("selectedPoster"),a=localStorage.getItem("selectedGender"),s=localStorage.getItem("sessionId")||"";if(!e||!t||!a)return void j.push("/generate/gender");x(s),m(e),s&&(0,n.Pn)(s,"result_generated",{page:"result_page",gender:a,selected_poster:t,timestamp:new Date().toISOString()}),y(e,t,a,s)},[j]);let y=async(e,a,s,r)=>{try{t(!0),o(null),u(10),console.log("Starting face swap process:",{posterName:a,gender:s});let l=await fetch(e),i=await l.blob();console.log("User image blob size:",i.size),u(30);let d=new FormData;d.append("userImage",i,"user-photo.jpg"),d.append("posterName",a),d.append("sessionId",r),u(50),console.log("Calling face swap API...");let m=await fetch("/api/process-faceswap",{method:"POST",body:d});if(u(70),console.log("Face swap API response status:",m.status),!m.ok){let e=await m.json();throw console.error("Face swap API error:",e),Error(e.error||"HTTP ".concat(m.status,": Face swap processing failed"))}let g=await m.json();if(console.log("Face swap result:",{success:g.success,hasImage:!!g.imageUrl}),u(90),g.success&&g.imageUrl){w(g.imageUrl),u(75),console.log("Face swap completed successfully, starting hair swap...");let e=null;r&&(e=await (0,n.ai)(g.imageUrl,r,"generated_poster","face_swapped_poster_".concat(Date.now(),".jpg"))),r&&(await (0,n.pR)(r,{processing_status:"completed",result_image_generated:!0,generated_image_url:null==e?void 0:e.url,generated_image_path:null==e?void 0:e.path,hair_swap_completed:!0}),await (0,n.Pn)(r,"result_generated",{action:"face_and_hair_swap_completed",success:!0,generated_image_stored:!!e,storage_url:null==e?void 0:e.url,storage_path:null==e?void 0:e.path,timestamp:new Date().toISOString()})),c(g.imageUrl),u(100),console.log("Face and hair swap completed successfully with FaceSwap v4!")}else throw Error(g.error||"Processing failed - no image returned")}catch(t){console.error("Face swap error:",t);let e="An error occurred during processing";t instanceof Error?e=t.message:"string"==typeof t&&(e=t),e.includes("API configuration error")?e="Service temporarily unavailable. Please try again later.":e.includes("timed out")?e="Processing is taking longer than expected. Please try again.":e.includes("Face swap service unavailable")&&(e="AI service is currently unavailable. Please try again in a few minutes."),o(e),r&&(await (0,n.pR)(r,{processing_status:"failed",error_message:e}),await (0,n.Pn)(r,"error",{error_type:"face_swap_error",error_message:e,timestamp:new Date().toISOString()}))}finally{t(!1)}},N=async()=>{if(i&&p){await (0,n.MH)(p,"generated_poster","direct_download"),await (0,n.Pn)(p,"result_generated",{action:"image_downloaded",image_type:h?"hair_swapped":"face_swapped",download_timestamp:new Date().toISOString()});let e=document.createElement("a");e.href=i,e.download="divine-parimatch-poster-".concat(h?"hair-swapped":"face-swapped","-").concat(Date.now(),".jpg"),e.setAttribute("target","_blank"),document.body.appendChild(e),e.click(),document.body.removeChild(e),console.log("Image download initiated:",h?"hair-swapped version":"face-swapped version")}},F=()=>{localStorage.removeItem("userImage"),localStorage.removeItem("selectedPoster"),localStorage.removeItem("selectedGender"),j.push("/generate/gender")};return e?(0,s.jsx)("div",{className:"w-full",children:(0,s.jsxs)("section",{className:"relative w-full bg-no-repeat bg-center min-h-screen",style:{backgroundImage:"url('/images/secondpage/Desktop.png')",backgroundSize:"cover"},children:[(0,s.jsx)("div",{className:"absolute inset-0 block md:hidden bg-no-repeat bg-center",style:{backgroundImage:"url('/images/mobile/mobile.png')",backgroundSize:"cover"}}),(0,s.jsxs)("div",{className:"relative z-10 w-full h-full flex flex-col px-4 md:px-6 py-6",children:[(0,s.jsx)("div",{className:"flex justify-start md:justify-start justify-center mb-8",style:{marginLeft:"0px md:50px"},children:(0,s.jsx)("button",{onClick:()=>window.location.href="/",className:"transition-all duration-200 hover:opacity-80",children:(0,s.jsx)("img",{src:"/images/landing/normalimages/parimatch.svg",alt:"Parimatch Logo",className:"h-16 md:h-16"})})}),(0,s.jsx)("div",{className:"flex justify-center mb-4",children:(0,s.jsx)("div",{className:"flex items-center",children:[1,2,3,4].map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-full border-2 flex items-center justify-center font-bold font-poppins text-sm md:text-base",style:{borderColor:"#F8FF13",backgroundColor:"#F8FF13",color:"black"},children:e}),t<3&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-2 md:w-4"}),(0,s.jsx)("div",{className:"w-8 md:w-16 h-0.5 bg-white"}),(0,s.jsx)("div",{className:"w-2 md:w-4"})]})]},e))})}),(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"relative px-8 py-12 md:px-16 md:py-8 rounded-lg",style:{border:"2px solid #F8FF13",backgroundColor:"rgba(17, 17, 18, 0.95)",minWidth:"320px",maxWidth:"500px",minHeight:"200px"},children:[(0,s.jsx)("button",{className:"absolute top-2 right-3 text-white hover:text-gray-300 text-xl font-bold",style:{fontSize:"24px",lineHeight:"1"},children:"\xd7"}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-white text-lg font-poppins mb-6",children:g<75?"Crafting your debut with your favorite artist...":g<100?"Adding your unique hairstyle to the poster...":"Creating your personalized poster..."}),(0,s.jsx)("div",{className:"w-full bg-gray-600 rounded-full h-3",children:(0,s.jsx)("div",{className:"h-3 rounded-full transition-all duration-500",style:{width:"".concat(g,"%"),backgroundColor:"#F8FF13"}})})]})]})})]})]})}):a?(0,s.jsx)("div",{className:"w-full",children:(0,s.jsxs)("section",{className:"relative w-full bg-no-repeat bg-center min-h-screen",style:{backgroundImage:"url('/images/secondpage/Desktop.png')",backgroundSize:"cover"},children:[(0,s.jsx)("div",{className:"absolute inset-0 block md:hidden bg-no-repeat bg-center",style:{backgroundImage:"url('/images/mobile/mobile.png')",backgroundSize:"cover"}}),(0,s.jsxs)("div",{className:"relative z-10 w-full h-full flex flex-col px-4 md:px-6 py-6",children:[(0,s.jsx)("div",{className:"flex justify-start md:justify-start justify-center mb-8",style:{marginLeft:"0px md:50px"},children:(0,s.jsx)("button",{onClick:()=>window.location.href="/",className:"transition-all duration-200 hover:opacity-80",children:(0,s.jsx)("img",{src:"/images/landing/normalimages/parimatch.svg",alt:"Parimatch Logo",className:"h-16 md:h-16"})})}),(0,s.jsx)("div",{className:"flex justify-center mb-4",children:(0,s.jsx)("div",{className:"flex items-center",children:[1,2,3,4].map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-full border-2 flex items-center justify-center font-bold font-poppins text-sm md:text-base",style:{borderColor:"#F8FF13",backgroundColor:"#F8FF13",color:"black"},children:e}),t<3&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-2 md:w-4"}),(0,s.jsx)("div",{className:"w-8 md:w-16 h-0.5 bg-white"}),(0,s.jsx)("div",{className:"w-2 md:w-4"})]})]},e))})}),(0,s.jsx)("div",{className:"flex justify-center items-center flex-1",children:(0,s.jsx)("div",{className:"w-full max-w-2xl px-12 py-8 rounded-lg relative",style:{border:"2px solid transparent",backgroundImage:"linear-gradient(#111112, #111112), linear-gradient(45deg, #8F9093, #C0C4C8, #BDBDBD, #959FA7, #666666)",backgroundOrigin:"border-box",backgroundClip:"padding-box, border-box"},children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{className:"text-white text-2xl font-medium mb-8 font-poppins",children:"Processing Failed"}),(0,s.jsx)("div",{className:"bg-red-900/20 border border-red-500 rounded-lg p-6 mb-8",children:(0,s.jsx)("p",{className:"text-red-300 font-poppins",children:a})}),(0,s.jsx)("button",{onClick:F,className:"px-16 py-3 font-normal text-lg uppercase tracking-wide transform -skew-x-12 transition-all duration-200 font-poppins",style:{background:"#F8FF13",color:"black",border:"0.5px solid transparent",backgroundImage:"linear-gradient(#F8FF13, #F8FF13), linear-gradient(45deg, #8F9093, #C0C4C8, #BDBDBD, #959FA7, #666666)",backgroundOrigin:"border-box",backgroundClip:"padding-box, border-box"},children:(0,s.jsx)("span",{className:"block transform skew-x-12",children:"TRY AGAIN"})})]})})})]})]})}):(0,s.jsx)("div",{className:"w-full",children:(0,s.jsxs)("section",{className:"relative w-full bg-no-repeat bg-center min-h-screen",style:{backgroundImage:"url('/images/secondpage/Desktop.png')",backgroundSize:"cover"},children:[(0,s.jsx)("div",{className:"absolute inset-0 block md:hidden bg-no-repeat bg-center",style:{backgroundImage:"url('/images/mobile/mobile.png')",backgroundSize:"cover"}}),(0,s.jsxs)("div",{className:"relative z-10 w-full h-full flex flex-col px-4 md:px-6 py-6",children:[(0,s.jsx)("div",{className:"flex justify-center md:justify-start mb-8",children:(0,s.jsx)("div",{className:"md:ml-12",children:(0,s.jsx)("button",{onClick:()=>window.location.href="/",className:"transition-all duration-200 hover:opacity-80",children:(0,s.jsx)("img",{src:"/images/landing/normalimages/parimatch.svg",alt:"Parimatch Logo",className:"h-16 md:h-16"})})})}),(0,s.jsx)("div",{className:"flex justify-center mb-4 md:mb-6",children:(0,s.jsx)("div",{className:"flex items-center",children:[1,2,3,4].map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 md:w-8 md:h-8 rounded-full border-2 flex items-center justify-center font-bold font-poppins text-sm md:text-sm",style:{borderColor:"#F8FF13",backgroundColor:"#F8FF13",color:"black"},children:e}),t<3&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-2 md:w-2"}),(0,s.jsx)("div",{className:"w-8 md:w-8 h-0.5 bg-white"}),(0,s.jsx)("div",{className:"w-2 md:w-2"})]})]},e))})}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col lg:grid lg:grid-cols-2 gap-6 items-center max-w-sm md:max-w-none mx-auto lg:mx-0 lg:pl-8 lg:pr-8",children:[(0,s.jsx)("div",{className:"flex justify-center lg:justify-end lg:transform lg:translate-x-[-100px]",children:(0,s.jsx)("div",{className:"relative rounded-lg overflow-hidden",style:{border:"1px solid #F8FF13",maxWidth:"300px",width:"100%"},children:i&&(0,s.jsx)("img",{src:i,alt:"Generated Poster",className:"w-full h-auto object-cover"})})}),(0,s.jsxs)("div",{className:"flex flex-col justify-center text-center lg:text-center lg:pl-4 lg:transform lg:translate-x-[-80px]",children:[(0,s.jsxs)("h1",{className:"text-white text-base md:text-xl lg:text-2xl font-bold mb-3 md:mb-4 font-poppins",children:["HERE'S YOUR PERSONALIZED",(0,s.jsx)("br",{}),"POSTER ",(0,s.jsx)("span",{style:{color:"#F8FF13"},children:"WITH DIVINE HIMSELF!"})]}),(0,s.jsxs)("div",{className:"text-white text-xs md:text-sm lg:text-sm mb-4 md:mb-6 font-poppins leading-tight",children:[(0,s.jsxs)("p",{className:"mb-0",children:["Download & participate in ",(0,s.jsx)("span",{style:{color:"#F8FF13"},children:"#DIVINExParimatch"})]}),(0,s.jsx)("p",{className:"mb-0",style:{color:"#F8FF13"},children:"to win exciting prizes!"}),(0,s.jsx)("p",{children:"Check out our Instagram page for contest details!"})]}),(0,s.jsx)("div",{className:"mb-4 md:mb-6",children:(0,s.jsx)("button",{onClick:N,disabled:e,className:"px-6 py-2 md:px-10 md:py-3 font-normal text-base md:text-lg uppercase tracking-wider transition-all duration-200 hover:scale-105 font-poppins disabled:opacity-50 disabled:cursor-not-allowed",style:{background:e?"#666":"#F8FF13",color:"black",border:"none",borderRadius:"5px"},children:"DOWNLOAD"})}),(0,s.jsxs)("div",{className:"text-white font-poppins",children:[(0,s.jsx)("p",{className:"text-xs md:text-sm lg:text-sm mb-0",children:"Not vibing with this one?"}),(0,s.jsx)("p",{className:"text-xs md:text-sm lg:text-sm mb-3",children:"Hit refresh and let's create another legend!"}),(0,s.jsx)("button",{onClick:F,className:"px-6 py-2 md:px-10 md:py-3 font-normal text-base md:text-lg uppercase tracking-wider transition-all duration-200 hover:scale-105 font-poppins",style:{background:"#F8FF13",color:"black",border:"none",borderRadius:"5px"},children:"TRY AGAIN"})]})]})]})]})]})})}function i(){return(0,s.jsx)(r.Suspense,{fallback:(0,s.jsx)("div",{children:"Loading..."}),children:(0,s.jsx)(o,{})})}},2099:(e,t,a)=>{"use strict";a.d(t,{MH:()=>u,Pn:()=>l,Vh:()=>n,ai:()=>g,f6:()=>i,pR:()=>o,ps:()=>r});let s=(0,a(4982).UU)("https://nuoizrqsnxoldzcvwszu.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im51b2l6cnFzbnhvbGR6Y3Z3c3p1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAyNTAwOTAsImV4cCI6MjA2NTgyNjA5MH0.QBqYuv2uxdNiakLzrW_CosJnN0vTvTwlGT2UvAZFYlY"),r=async e=>{try{let{data:t,error:a}=await s.from("user_sessions").insert([{session_id:e}]).select();if(a)throw a;return t}catch(e){return console.error("Error tracking user session:",e),null}},l=async(e,t,a)=>{try{let{data:r,error:l}=await s.from("user_journey").insert([{session_id:e,step:t,data:a,timestamp:new Date().toISOString()}]).select();if(l)throw l;return r}catch(e){return console.error("Error tracking user step:",e),null}},n=async(e,t)=>{try{let{data:a,error:r}=await s.from("generation_results").insert([{session_id:e,...t,created_at:new Date().toISOString()}]).select();if(r)throw r;return a}catch(e){return console.error("Error tracking generation result:",e),null}},o=async(e,t)=>{try{let{data:a,error:r}=await s.from("generation_results").update(t).eq("session_id",e).select();if(r)throw r;return a}catch(e){return console.error("Error updating generation result:",e),null}},i=()=>"session_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),c=async(e,t,a)=>{try{let r="user_photo"===a?"user-photos":"generated-posters",l=e instanceof File?e.name.split(".").pop():"jpg",n="".concat(t,"_").concat(Date.now(),".").concat(l),o="".concat(a,"/").concat(n),{data:i,error:c}=await s.storage.from(r).upload(o,e);if(c)return console.error("Error uploading image:",c),null;let{data:{publicUrl:d}}=s.storage.from(r).getPublicUrl(o);return{url:d,path:o}}catch(e){return console.error("Error in uploadImageToStorage:",e),null}},d=async(e,t,a,r,l,n)=>{try{let o={session_id:e,image_type:t,original_filename:n||(l instanceof File?l.name:void 0),storage_path:a,storage_url:r,file_size:null==l?void 0:l.size,mime_type:null==l?void 0:l.type,upload_status:"uploaded"},{data:i,error:c}=await s.from("image_storage").insert([o]).select();if(c)throw c;return i}catch(e){return console.error("Error tracking image storage:",e),null}},m=e=>{let t=e.replace(/^data:image\/[a-z]+;base64,/,""),a=window.atob(t),s=new Uint8Array(a.length);for(let e=0;e<a.length;e++)s[e]=a.charCodeAt(e);return new Blob([s],{type:"image/jpeg"})},g=async(e,t,a,s)=>{try{let r=m(e),l=await c(r,t,a);return l&&await d(t,a,l.path,l.url,r,s),l}catch(e){return console.error("Error uploading base64 image:",e),null}},u=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"generated_poster",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"direct_download";try{let r={session_id:e,image_type:t,download_method:a,user_agent:"undefined"!=typeof navigator?navigator.userAgent:void 0},{data:l,error:n}=await s.from("download_tracking").insert([r]).select();if(n)throw n;return l}catch(e){return console.error("Error tracking download:",e),null}}},5695:(e,t,a)=>{"use strict";var s=a(8999);a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})},9468:(e,t,a)=>{Promise.resolve().then(a.bind(a,142))}},e=>{var t=t=>e(e.s=t);e.O(0,[982,441,684,358],()=>t(9468)),_N_E=e.O()}]);