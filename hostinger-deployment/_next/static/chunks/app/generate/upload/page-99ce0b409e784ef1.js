(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[296],{180:(e,t,r)=>{Promise.resolve().then(r.bind(r,290))},290:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var a=r(5155),s=r(2115),n=r(5695),o=r(2099);function i(){let[e,t]=(0,s.useState)(null),[r,i]=(0,s.useState)(!1),[l,c]=(0,s.useState)(!1),[d,p]=(0,s.useState)(!1),[u,m]=(0,s.useState)(!0),[g,x]=(0,s.useState)(!1),[h,f]=(0,s.useState)(""),b=(0,n.useSearchParams)(),w=(0,n.useRouter)(),j=b.get("gender"),y=b.get("poster");(0,s.useEffect)(()=>{if(!j||!y)return void w.push("/generate/gender");(async()=>{let e=localStorage.getItem("sessionId")||"";f(e),e&&await (0,o.Pn)(e,"photo_upload",{page:"photo_upload",gender:j,selected_poster:y,timestamp:new Date().toISOString()})})()},[j,y,w]);let v=async e=>{if(e&&e.type.startsWith("image/")){let r=new FileReader;r.onload=async r=>{var a,s;if(t(null==(a=r.target)?void 0:a.result),p(!0),h){let t=await (0,o.ai)(null==(s=r.target)?void 0:s.result,h,"user_photo",e.name);await (0,o.Pn)(h,"photo_upload",{action:"photo_uploaded",file_type:e.type,file_size:e.size,gender:j,selected_poster:y,image_uploaded_to_storage:!!t,storage_url:null==t?void 0:t.url,storage_path:null==t?void 0:t.path,timestamp:new Date().toISOString()})}},r.readAsDataURL(e)}},k=async()=>{if(e&&y&&j&&h){x(!0);try{let t=await (0,o.ai)(e,h,"user_photo","user-photo.jpg");await (0,o.Vh)(h,{gender:j,poster_selected:y,user_image_uploaded:!0,user_image_url:null==t?void 0:t.url,user_image_path:null==t?void 0:t.path,processing_status:"started",result_image_generated:!1}),await (0,o.Pn)(h,"processing",{action:"generation_started",gender:j,selected_poster:y,timestamp:new Date().toISOString()}),localStorage.setItem("userImage",e),localStorage.setItem("selectedPoster",y),localStorage.setItem("selectedGender",j),w.push("/generate/result?gender=".concat(j,"&poster=").concat(encodeURIComponent(y)))}catch(e){console.error("Error processing:",e),h&&await (0,o.Pn)(h,"error",{error_type:"submit_error",error_message:e instanceof Error?e.message:"Unknown error",timestamp:new Date().toISOString()}),x(!1)}}},N=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}}),t=document.createElement("video");t.srcObject=e,t.autoplay=!0,t.playsInline=!0;let r=document.createElement("canvas"),a=r.getContext("2d"),s=document.createElement("div");s.style.cssText="\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0,0,0,0.9);\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: center;\n        z-index: 1000;\n      ",t.style.cssText="\n        max-width: 90%;\n        max-height: 70%;\n        border: 2px solid #F8FF13;\n      ";let n=document.createElement("button");n.textContent="Capture Photo",n.style.cssText="\n        margin-top: 20px;\n        padding: 10px 20px;\n        background: #F8FF13;\n        color: black;\n        border: none;\n        border-radius: 5px;\n        font-size: 16px;\n        cursor: pointer;\n      ";let o=document.createElement("button");o.textContent="\xd7",o.style.cssText="\n        position: absolute;\n        top: 20px;\n        right: 20px;\n        background: none;\n        border: none;\n        color: white;\n        font-size: 30px;\n        cursor: pointer;\n      ",s.appendChild(t),s.appendChild(n),s.appendChild(o),document.body.appendChild(s),n.onclick=()=>{r.width=t.videoWidth,r.height=t.videoHeight,null==a||a.drawImage(t,0,0),r.toBlob(e=>{if(e){let t=new File([e],"camera-photo.jpg",{type:"image/jpeg"});v(t)}},"image/jpeg",.8),e.getTracks().forEach(e=>e.stop()),document.body.removeChild(s),c(!1)},o.onclick=()=>{e.getTracks().forEach(e=>e.stop()),document.body.removeChild(s)}}catch(t){console.error("Camera access denied or not available:",t);let e=document.createElement("input");e.type="file",e.accept="image/*",e.capture="camera",e.onchange=e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];r&&(v(r),c(!1))},e.click()}};return(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("section",{className:"relative w-full bg-no-repeat bg-center min-h-screen",style:{backgroundImage:"url('/images/secondpage/Desktop.png')",backgroundSize:"cover"},children:(0,a.jsxs)("div",{className:"relative z-10 w-full h-full flex flex-col px-4 md:px-6 py-6",children:[(0,a.jsx)("div",{className:"flex justify-center md:justify-start mb-8",children:(0,a.jsx)("button",{onClick:()=>window.location.href="/",className:"transition-all duration-200 hover:opacity-80",children:(0,a.jsx)("img",{src:"/images/landing/normalimages/parimatch.svg",alt:"Parimatch Logo",className:"h-16 md:h-16"})})}),(0,a.jsx)("div",{className:"flex justify-center mb-4 md:mb-6",children:(0,a.jsx)("div",{className:"flex items-center",children:[1,2,3,4].map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 md:w-8 md:h-8 rounded-full border-2 flex items-center justify-center font-bold font-poppins text-sm md:text-sm",style:{borderColor:1===e||2===e||3===e?"#F8FF13":"white",backgroundColor:1===e||2===e||3===e?"#F8FF13":"transparent",color:1===e||2===e||3===e?"black":"white"},children:e}),t<3&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-2 md:w-2"}),(0,a.jsx)("div",{className:"w-8 md:w-8 h-0.5 bg-white"}),(0,a.jsx)("div",{className:"w-2 md:w-2"})]})]},e))})}),(0,a.jsx)("div",{className:"flex justify-center items-center flex-1",children:(0,a.jsxs)("div",{className:"w-full max-w-4xl px-12 py-8 rounded-lg relative",style:{border:"2px solid transparent",backgroundImage:"linear-gradient(#111112, #111112), linear-gradient(45deg, #8F9093, #C0C4C8, #BDBDBD, #959FA7, #666666)",backgroundOrigin:"border-box",backgroundClip:"padding-box, border-box"},children:[(0,a.jsx)("button",{onClick:()=>window.location.href="/generate/poster?gender=".concat(j),className:"absolute top-4 left-4 transition-all duration-200 hover:opacity-75",children:(0,a.jsx)("img",{src:"/images/icons/backbutton.png",alt:"Back",className:"w-8 h-8"})}),(0,a.jsx)("h2",{className:"text-white text-xl md:text-2xl font-medium text-center mb-8 font-poppins",children:"Upload Your Photo"}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-center space-y-8 md:space-y-0 md:space-x-12 mb-12",children:[(0,a.jsxs)("div",{className:"hidden md:flex items-center space-x-8",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("img",{src:"/images/uploadpage/instructions.png",alt:"Instructions",className:"h-36 w-auto object-contain"})}),(0,a.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsx)("img",{src:"/images/uploadpage/wrong.png",alt:"Wrong example",className:"h-32 w-auto object-contain"})}),(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsx)("img",{src:"/images/uploadpage/right.png",alt:"Right example",className:"h-32 w-auto object-contain"})})]})]}),(0,a.jsx)("div",{className:"flex justify-center items-center",children:(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"w-64 h-64 border-2 border-dashed rounded-lg flex flex-col items-center justify-center cursor-pointer transition-all duration-200",style:{borderColor:r?"#F8FF13":"#666666",backgroundColor:r?"rgba(248, 255, 19, 0.1)":"transparent"},onDrop:e=>{e.preventDefault(),i(!1);let t=e.dataTransfer.files;t[0]&&v(t[0])},onDragOver:e=>{e.preventDefault(),i(!0)},onDragLeave:()=>i(!1),onClick:()=>c(!0),children:(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,a.jsx)("img",{src:"/images/icons/upload.png",alt:"Upload",className:"w-12 h-12"}),(0,a.jsxs)("div",{className:"text-white text-base font-poppins text-center",children:["Upload your image",(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"Click or drag & drop"})]})]})})})})]})]})})]})}),l&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"relative rounded-lg p-6 w-80 md:w-auto",style:{backgroundColor:"#111112",border:"0.5px solid #F8FF13"},children:[(0,a.jsx)("button",{onClick:()=>c(!1),className:"absolute top-3 right-3 text-white hover:text-gray-300 text-xl font-bold",children:"\xd7"}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-6 py-4",children:[(0,a.jsxs)("button",{onClick:N,className:"w-full md:w-auto flex items-center justify-center space-x-2 px-6 py-3 rounded-lg transition-colors",style:{border:"0.5px solid #F8FF13",backgroundImage:"linear-gradient(to right, #161616 0%, #565656 100%)"},children:[(0,a.jsx)("span",{className:"text-white font-poppins",children:"Use Camera"}),(0,a.jsxs)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0118.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})]}),(0,a.jsx)("div",{className:"text-white font-poppins",children:"or"}),(0,a.jsxs)("button",{onClick:()=>{let e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];r&&(v(r),c(!1))},e.click()},className:"w-full md:w-auto flex items-center justify-center space-x-2 px-6 py-3 rounded-lg transition-colors",style:{border:"0.5px solid #F8FF13",backgroundImage:"linear-gradient(to right, #161616 0%, #565656 100%)"},children:[(0,a.jsx)("span",{className:"text-white font-poppins",children:"Upload"}),(0,a.jsx)("img",{src:"/images/icons/upload.png",alt:"Upload",className:"w-5 h-5"})]}),(0,a.jsx)("div",{className:"text-gray-400 text-xs md:text-sm font-poppins text-center md:text-left",children:"( supported file formats jpg, png, pdf )"})]})]})}),u&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 md:hidden",children:(0,a.jsx)("div",{className:"relative rounded-lg p-6 w-80 max-w-sm mx-4",style:{backgroundColor:"#111112",border:"0.5px solid #F8FF13"},children:(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-6 py-4",children:[(0,a.jsx)("h3",{className:"text-white text-lg font-medium font-poppins text-center",children:"Photo Guidelines"}),(0,a.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsx)("img",{src:"/images/uploadpage/wrong.png",alt:"Wrong example",className:"h-24 w-auto object-contain"})}),(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsx)("img",{src:"/images/uploadpage/right.png",alt:"Right example",className:"h-24 w-auto object-contain"})})]}),(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsx)("img",{src:"/images/uploadpage/instructions.png",alt:"Instructions",className:"h-32 w-auto object-contain"})}),(0,a.jsx)("button",{onClick:()=>m(!1),className:"px-8 py-3 font-normal text-lg uppercase tracking-wide transform -skew-x-12 transition-all duration-200 font-poppins",style:{background:"#F8FF13",color:"black",border:"0.5px solid transparent",backgroundImage:"linear-gradient(#F8FF13, #F8FF13), linear-gradient(45deg, #8F9093, #C0C4C8, #BDBDBD, #959FA7, #666666)",backgroundOrigin:"border-box",backgroundClip:"padding-box, border-box",cursor:"pointer"},children:(0,a.jsx)("span",{className:"block transform skew-x-12",children:"UNDERSTOOD"})})]})})}),d&&e&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"relative rounded-lg p-8 w-96 md:w-auto max-w-2xl",style:{backgroundColor:"#111112",border:"0.5px solid #F8FF13"},children:[(0,a.jsx)("button",{onClick:()=>{p(!1),t(null)},className:"absolute top-3 right-3 text-white hover:text-gray-300 text-xl font-bold",children:"\xd7"}),(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-6 py-4",children:[(0,a.jsx)("h3",{className:"text-white text-xl font-medium font-poppins text-center",children:"Preview Your Photo"}),(0,a.jsx)("div",{className:"w-80 h-80 bg-gray-300 rounded-lg overflow-hidden",children:(0,a.jsx)("img",{src:e,alt:"Photo preview",className:"w-full h-full object-cover"})}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-6",children:[(0,a.jsx)("button",{onClick:()=>{p(!1),t(null)},className:"px-8 py-3 font-normal text-lg uppercase tracking-wide transform -skew-x-12 transition-all duration-200 font-poppins",style:{background:"#666666",color:"white",border:"0.5px solid transparent",backgroundImage:"linear-gradient(#666666, #666666), linear-gradient(45deg, #8F9093, #C0C4C8, #BDBDBD, #959FA7, #666666)",backgroundOrigin:"border-box",backgroundClip:"padding-box, border-box",cursor:"pointer"},children:(0,a.jsx)("span",{className:"block transform skew-x-12",children:"RETAKE PHOTO"})}),(0,a.jsx)("button",{onClick:k,disabled:g,className:"px-12 py-3 font-normal text-lg uppercase tracking-wide transform -skew-x-12 transition-all duration-200 font-poppins",style:{background:g?"#585858":"#F8FF13",color:"black",border:g?"none":"0.5px solid transparent",backgroundImage:g?"none":"linear-gradient(#F8FF13, #F8FF13), linear-gradient(45deg, #8F9093, #C0C4C8, #BDBDBD, #959FA7, #666666)",backgroundOrigin:g?"initial":"border-box",backgroundClip:g?"initial":"padding-box, border-box",cursor:g?"not-allowed":"pointer",opacity:g?.7:1},children:(0,a.jsx)("span",{className:"block transform skew-x-12",children:g?"PROCESSING...":"SUBMIT"})})]})]})]})})]})}function l(){return(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)("div",{children:"Loading..."}),children:(0,a.jsx)(i,{})})}},2099:(e,t,r)=>{"use strict";r.d(t,{MH:()=>m,Pn:()=>n,Vh:()=>o,ai:()=>u,f6:()=>l,pR:()=>i,ps:()=>s});let a=(0,r(4982).UU)("https://nuoizrqsnxoldzcvwszu.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im51b2l6cnFzbnhvbGR6Y3Z3c3p1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAyNTAwOTAsImV4cCI6MjA2NTgyNjA5MH0.QBqYuv2uxdNiakLzrW_CosJnN0vTvTwlGT2UvAZFYlY"),s=async e=>{try{let{data:t,error:r}=await a.from("user_sessions").insert([{session_id:e}]).select();if(r)throw r;return t}catch(e){return console.error("Error tracking user session:",e),null}},n=async(e,t,r)=>{try{let{data:s,error:n}=await a.from("user_journey").insert([{session_id:e,step:t,data:r,timestamp:new Date().toISOString()}]).select();if(n)throw n;return s}catch(e){return console.error("Error tracking user step:",e),null}},o=async(e,t)=>{try{let{data:r,error:s}=await a.from("generation_results").insert([{session_id:e,...t,created_at:new Date().toISOString()}]).select();if(s)throw s;return r}catch(e){return console.error("Error tracking generation result:",e),null}},i=async(e,t)=>{try{let{data:r,error:s}=await a.from("generation_results").update(t).eq("session_id",e).select();if(s)throw s;return r}catch(e){return console.error("Error updating generation result:",e),null}},l=()=>"session_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),c=async(e,t,r)=>{try{let s="user_photo"===r?"user-photos":"generated-posters",n=e instanceof File?e.name.split(".").pop():"jpg",o="".concat(t,"_").concat(Date.now(),".").concat(n),i="".concat(r,"/").concat(o),{data:l,error:c}=await a.storage.from(s).upload(i,e);if(c)return console.error("Error uploading image:",c),null;let{data:{publicUrl:d}}=a.storage.from(s).getPublicUrl(i);return{url:d,path:i}}catch(e){return console.error("Error in uploadImageToStorage:",e),null}},d=async(e,t,r,s,n,o)=>{try{let i={session_id:e,image_type:t,original_filename:o||(n instanceof File?n.name:void 0),storage_path:r,storage_url:s,file_size:null==n?void 0:n.size,mime_type:null==n?void 0:n.type,upload_status:"uploaded"},{data:l,error:c}=await a.from("image_storage").insert([i]).select();if(c)throw c;return l}catch(e){return console.error("Error tracking image storage:",e),null}},p=e=>{let t=e.replace(/^data:image\/[a-z]+;base64,/,""),r=window.atob(t),a=new Uint8Array(r.length);for(let e=0;e<r.length;e++)a[e]=r.charCodeAt(e);return new Blob([a],{type:"image/jpeg"})},u=async(e,t,r,a)=>{try{let s=p(e),n=await c(s,t,r);return n&&await d(t,r,n.path,n.url,s,a),n}catch(e){return console.error("Error uploading base64 image:",e),null}},m=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"generated_poster",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"direct_download";try{let s={session_id:e,image_type:t,download_method:r,user_agent:"undefined"!=typeof navigator?navigator.userAgent:void 0},{data:n,error:o}=await a.from("download_tracking").insert([s]).select();if(o)throw o;return n}catch(e){return console.error("Error tracking download:",e),null}}},5695:(e,t,r)=>{"use strict";var a=r(8999);r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})}},e=>{var t=t=>e(e.s=t);e.O(0,[982,441,684,358],()=>t(180)),_N_E=e.O()}]);